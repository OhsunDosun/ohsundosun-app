소스 리펙토링 및 기능 추가